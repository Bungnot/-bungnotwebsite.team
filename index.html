<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="https://img2.pic.in.th/pic/unnamed-61092ef0931d49b03.jpg">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô ADMIN (Pro Version)</title>
    
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script defer data-domain="bungnot.pages.dev" src="https://plausible.io/js/script.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary-bg: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            --glass-bg: rgba(255, 255, 255, 0.95);
            --shadow: 0 8px 32px 0 rgba(4, 4, 4, 0.1);
            --color-green: #2ecc71;
            --color-orange: #f39c12;
            --color-red: #e74c3c;
            --color-purple: #9b59b6;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background: var(--primary-bg);
            padding: 20px;
            margin: 0;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
        }

        .header h1 {
            font-weight: 700;
            margin-bottom: 5px;
        }

        .main-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .info-card {
            background: var(--glass-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
            flex-grow: 1;
            max-width: 400px;
            min-width: 280px;
        }

        .info-card h3 {
            margin-top: 0;
            color: #2a5298;
            font-weight: 600;
        }

        .info-content ul {
            padding-left: 20px;
            margin: 0;
            list-style: disc;
        }

        .btn-main {
            background: #2a5298;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-main:hover {
            background: #1e3c72;
        }

        #tables-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            padding: 20px;
        }

        .table-container {
            background: var(--glass-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 700px;
            position: relative;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .table-title-input {
            font-size: 1.2rem;
            font-weight: 700;
            border: none;
            background: none;
            width: 100%;
            color: #2a5298;
            padding: 5px 0;
        }

        .table-title-input:focus {
            outline: 2px solid var(--color-purple);
            border-radius: 5px;
        }

        .btn-close-table {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .btn-close-table:hover {
            background: #c0392b;
        }

        .custom-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
        }

        .custom-table th, .custom-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        .custom-table th {
            color: white;
            font-weight: 600;
        }

        .th-green { background-color: var(--color-green); }
        .th-orange { background-color: var(--color-orange); }
        .th-red { background-color: var(--color-red); }
        .th-purple { background-color: var(--color-purple); }

        .custom-table input[type="text"] {
            width: 100%;
            box-sizing: border-box;
            border: none;
            padding: 5px;
            font-size: 1rem;
            text-align: center;
            background: none;
        }

        .custom-table input[type="text"]:focus {
            outline: 2px solid #2a5298;
            border-radius: 3px;
        }

        .btn-remove-row {
            background: var(--color-red);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .btn-remove-row:hover {
            background: #c0392b;
        }

        .btn-add-row {
            width: 100%;
            background: #2a5298;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
        }

        .btn-add-row:hover {
            background: #1e3c72;
            transform: translateY(-1px);
        }

        /* --- New Calculate Button --- */
        .btn-calculate-line {
            width: 100%; 
            background: #06c755; /* LINE Green */
            color: white; 
            border: none;
            padding: 12px; 
            border-radius: 10px; 
            cursor: pointer; 
            font-weight: 600; 
            transition: 0.2s; 
            font-size: 1rem;
            margin-top: 10px; /* ‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ú‡∏• */
            box-shadow: 0 4px 10px rgba(6, 199, 85, 0.3);
        }
        .btn-calculate-line:hover { 
            background: #05ae4a; 
            transform: translateY(-1px);
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-box {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            transform: scale(0.9);
            transition: transform 0.3s;
        }

        .modal-overlay.active .modal-box {
            transform: scale(1);
        }

        .modal-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .icon-warn { color: #f39c12; }
        .icon-error { color: #e74c3c; }
        .icon-success { color: #06c755; } /* ‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß LINE */

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #2a5298;
        }

        .modal-text {
            font-size: 1rem;
            color: #555;
            margin-bottom: 20px;
            text-align: left; /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô modal ‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô */
        }
        
        .modal-input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            font-size: 1rem;
        }

        .modal-actions {
            display: flex;
            justify-content: space-around;
            gap: 10px;
        }

        .btn-modal {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            flex-grow: 1;
        }

        .btn-confirm {
            background: #2ecc71;
            color: white;
        }

        .btn-cancel {
            background: #ccc;
            color: #333;
        }
        
        #auto-save-alert {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2a5298;
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            opacity: 0;
            transition: opacity 0.5s;
            font-weight: 600;
            z-index: 999;
        }
        
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
                align-items: center;
            }
            .table-container {
                padding: 15px;
                max-width: 100%;
            }
            .info-card {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏ú‡∏•‡∏ö‡∏±‡πâ‡∏á‡πÑ‡∏ü üöÄ</h1>
        <p>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
    </div>

    <div class="main-container">
        <div class="info-card">
            <h3><i class="fas fa-table"></i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏£‡∏≤‡∏á</h3>
            <div style="display: flex; gap: 10px;">
                <button onclick="addTable()" class="btn-main" style="flex-grow:1; justify-content:center;">
                    <i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
                </button>
                <button onclick="saveAllTables()" class="btn-main" style="flex-grow:1; background: var(--color-purple); justify-content:center;">
                    <i class="fas fa-save"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
            </div>
            
        </div>

        <div class="info-card">
            <h3><i class="fab fa-line"></i> ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° Line OA</h3>
            <input type="text" id="lineName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÑ‡∏•‡∏ô‡πå OA">
            <textarea id="messageToSend" placeholder="‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á" rows="3"></textarea>
            <button onclick="sendMessageToLine()" class="btn-main" style="width:100%; justify-content:center; background: #06c755; color: white;">
                ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
            </button>
        </div>

        <div class="info-card">
            <h3><i class="fas fa-exclamation-triangle"></i> ‡∏Ç‡πâ‡∏≠‡∏´‡πâ‡∏≤‡∏° & ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h3>
            <div class="info-content">
                <ul>
                    <li>‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏™‡πà‡πÄ‡∏•‡∏Ç 3 ‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤</li>
                    <li>‡∏´‡∏≤‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏ú‡∏• ‡∏Å‡∏î‡∏•‡∏ö‡πÅ‡∏ñ‡∏ß‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</li>
                    <li>**‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö‡πÅ‡∏ñ‡∏ß‡πÄ‡∏™‡∏°‡∏≠**</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="tables-container"></div>

    <div id="custom-modal" class="modal-overlay">
        <div class="modal-box">
            <i id="modal-icon" class="fas fa-exclamation-circle modal-icon icon-warn"></i>
            <div id="modal-title" class="modal-title">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
            <div id="modal-msg" class="modal-text"></div>
            <div id="modal-actions" class="modal-actions">
                <button class="btn-modal btn-cancel" onclick="closeModal()">‡∏ï‡∏Å‡∏•‡∏á</button>
            </div>
        </div>
    </div>
    
    <div id="auto-save-alert">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß</div>

    <script src="script (13).js"></script>
</body>
</html>
